var g_sourceLines = [
'//',
'//',
'//',
'  //overall operation mechanism',
'  //(R1) granting read --write waits -&gt; grant write for next time',
'  //(R2) granting read --ONLY read waits OR no request -&gt; ... read ...',
'  //(W1) granting write --read waits -&gt; ... read ...',
'  //(W2) granting write--ONLY write waits OR no request -&gt; ... write ...',
'module arbiter(',
'	aclk,',
'	aresetn,',
'	sfifo_ar_empty_i,',
'	sfifo_aw_empty_i,',
'	burst_done_i,',
'	burst_go_i,',
'	//',
'	used_grant_o',
');',
'//*****************************************************************',
'//ports',
'//*****************************************************************',
'  input logic aclk;',
'  input logic aresetn;',
'  input logic sfifo_ar_empty_i;',
'  input logic sfifo_aw_empty_i;',
'  input logic burst_done_i;',
'  input logic burst_go_i;',
'  output logic [1:0] used_grant_o;',
'//*****************************************************************',
'//variables',
'//*****************************************************************',
'  logic [1:0] nextSel;',
'  logic [1:0] nextGrant;',
'  logic [1:0] current_grant;',
'  logic rd_req_avail, wr_req_avail;',
'  logic update;',
'  //',
'  //output assignment',
'  assign used_grant_o = current_grant;',
'  //',
'  assign rd_req_avail = ~sfifo_ar_empty_i;',
'  assign wr_req_avail = ~sfifo_aw_empty_i;',
'  //',
'  //nextSel0',
'  always_comb begin',
'    if(current_grant[0])',
'	  nextSel[0] = 1\'b1;',
'	else if(rd_req_avail)',
'	  nextSel[0] = 1\'b0;',
'	else',
'	  nextSel[0] = 1\'b1;',
'  end',
'  //nextSel1',
'  always_comb begin',
'    if(current_grant[1])',
'	  nextSel[1] = 1\'b1;',
'	else if(wr_req_avail)',
'	  nextSel[1] = 1\'b0;',
'	else',
'	  nextSel[1] = 1\'b1;',
'  end',
'  //nextGrant[1]',
'  always_comb begin',
'    if(~nextSel[0])',
'	  nextGrant[1] = 1\'b0;',
'	else if(wr_req_avail) //	R1',
'	  nextGrant[1] = 1\'b1;',
'	else',
'	  nextGrant[1] = current_grant[1]; //R2',
'  end',
'  //nextGrant[0]',
'  always_comb begin',
'    if(~nextSel[1])',
'	  nextGrant[0] = 1\'b0;',
'	else if(rd_req_avail) //W1',
'	  nextGrant[0] = 1\'b1;',
'	else',
'	  nextGrant[0] = current_grant[0]; //W2',
'  end',
'//',
'//current_grant',
'//',
'assign update = (burst_go_i ? 1\'b0 : (current_grant[0] ? (wr_req_avail &amp; sfifo_ar_empty_i) : (rd_req_avail &amp; sfifo_aw_empty_i)))',
'| burst_done_i;',
'//',
'always_ff @(posedge aclk, negedge aresetn) begin',
'	if(~aresetn)',
'		current_grant[1:0] &lt;= 2\'b01;',
'	else if(update)',
'		current_grant[1:0] &lt;= nextGrant[1:0];',
'	else',
'		current_grant[1:0] &lt;= current_grant[1:0];	  ',
'end',
'//',
'//',
'//',
'endmodule',
''
];
countinueBuildStmtTable(g_sourceLines);
